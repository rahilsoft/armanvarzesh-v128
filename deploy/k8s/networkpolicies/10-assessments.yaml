apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata: { name: allow-assessments }
spec:
  podSelector:
    matchLabels: { app: assessments }
  ingress:
  - from:
    - podSelector: { matchLabels: { app: api-gateway } }
    ports: [{ port: 3000, protocol: TCP }]
  egress:
  - to:
    - podSelector: { matchLabels: { app: api-gateway } }
    - podSelector: { matchLabels: { app: otel-collector } }
    - podSelector: { matchLabels: { app: postgres } }
    - podSelector: { matchLabels: { app: tempo } }
    - podSelector: { matchLabels: { app: loki } }
    ports:
    - port: 3000
      protocol: TCP
    - port: 4318
      protocol: TCP
  policyTypes: ["Ingress","Egress"]
