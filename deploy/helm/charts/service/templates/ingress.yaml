{- if .Values.ingress.enabled }
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: { { include "service.fullname" . } }
  annotations:
    {- if .Values.ingress.className }
    kubernetes.io/ingress.class: { { .Values.ingress.className } }
    {- end }
    {- if .Values.ingress.certManagerIssuer }
    cert-manager.io/cluster-issuer: { { .Values.ingress.certManagerIssuer } }
    {- end }
spec:
  {- if .Values.ingress.tls }
  tls:
  {- range .Values.ingress.tls }
    - hosts: [{ { join "," .hosts } }]
      secretName: "${SECRETNAME}"  # from env/secret manager
  {- end }
  {- end }
  rules:
  {- range .Values.ingress.hosts }
    - host: { { .host } }
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: { { include "service.fullname" $ } }
                port:
                  number: { { $.Values.service.port } }
  {- end }
{- end }
